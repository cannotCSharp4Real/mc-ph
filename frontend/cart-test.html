<!DOCTYPE html>
<html>
<head>
    <title>Cart Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-panel { background: #f0f0f0; padding: 20px; margin: 20px 0; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .product-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Cart Functionality Test</h1>
    
    <div class="test-panel">
        <h2>Authentication Status</h2>
        <p>Status: <span id="authStatus">Checking...</span></p>
        <button onclick="simulateAuth()">Simulate Login</button>
        <button onclick="clearAuth()">Clear Auth</button>
    </div>

    <div class="test-panel">
        <h2>Product Test</h2>
        <div class="product-card">
            <h3>Spanish Latte</h3>
            <p>Test product for cart functionality</p>
            <button onclick="openCustomization('test-product-id')">Add to Cart</button>
        </div>
    </div>

    <script>
        let isAuthenticated = false;
        let currentUser = null;

        function checkAuthStatus() {
            const token = localStorage.getItem('authToken');
            const userData = localStorage.getItem('userData');
            
            if (token && userData) {
                isAuthenticated = true;
                currentUser = JSON.parse(userData);
                document.getElementById('authStatus').textContent = `Authenticated as ${currentUser.role}`;
            } else {
                isAuthenticated = false;
                currentUser = null;
                document.getElementById('authStatus').textContent = 'Not authenticated (Guest)';
            }
        }

        function simulateAuth() {
            localStorage.setItem('authToken', 'test-token');
            localStorage.setItem('userData', JSON.stringify({
                id: 'test-user',
                email: 'test@example.com',
                role: 'customer'
            }));
            checkAuthStatus();
        }

        function clearAuth() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            checkAuthStatus();
        }

        function openCustomization(productId) {
            console.log('üõí Opening customization for product:', productId);
            
            // Check if user is authenticated
            if (!isAuthenticated) {
                alert('Please sign in to add items to your cart');
                console.log('‚ùå User not authenticated, redirecting to auth page');
                // window.location.href = 'auth.html';
                return;
            }
            
            console.log('‚úÖ User authenticated, opening customization modal');
            alert('Opening customization modal for authenticated user');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
        });
    </script>
</body>
</html>
